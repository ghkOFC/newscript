-- Variáveis principais
local player = game.Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local humanoid = character:WaitForChild("Humanoid")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local teleportButtonClicked = false

-- Funções do Fly
local flying = false
local speed = 50
local bodyVelocity = nil
local bodyGyro = nil

-- Função de Fly
local function toggleFly()
    flying = not flying
    if flying then
        bodyVelocity = Instance.new("BodyVelocity")
        bodyVelocity.MaxForce = Vector3.new(400000, 400000, 400000)
        bodyVelocity.Velocity = Vector3.new(0, 0, 0)
        bodyVelocity.Parent = character.HumanoidRootPart

        bodyGyro = Instance.new("BodyGyro")
        bodyGyro.MaxTorque = Vector3.new(400000, 400000, 400000)
        bodyGyro.CFrame = character.HumanoidRootPart.CFrame
        bodyGyro.Parent = character.HumanoidRootPart
    else
        if bodyVelocity then
            bodyVelocity:Destroy()
            bodyVelocity = nil
        end
        if bodyGyro then
            bodyGyro:Destroy()
            bodyGyro = nil
        end
    end
end

-- Função de controle de movimento do Fly
local function moveFly()
    if flying then
        local direction = Vector3.new(0, 0, 0)

        if UserInputService:IsKeyDown(Enum.KeyCode.W) then
            direction = direction + character.HumanoidRootPart.CFrame.LookVector
        end
        if UserInputService:IsKeyDown(Enum.KeyCode.S) then
            direction = direction - character.HumanoidRootPart.CFrame.LookVector
        end
        if UserInputService:IsKeyDown(Enum.KeyCode.A) then
            direction = direction - character.HumanoidRootPart.CFrame.RightVector
        end
        if UserInputService:IsKeyDown(Enum.KeyCode.D) then
            direction = direction + character.HumanoidRootPart.CFrame.RightVector
        end
        if UserInputService:IsKeyDown(Enum.KeyCode.Space) then
            direction = direction + Vector3.new(0, 1, 0)
        end
        if UserInputService:IsKeyDown(Enum.KeyCode.LeftControl) then
            direction = direction - Vector3.new(0, 1, 0)
        end

        bodyVelocity.Velocity = direction.Unit * speed
    end
end

-- Monitoramento de teclas para Fly
UserInputService.InputBegan:Connect(function(input, gameProcessed)
    if gameProcessed then return end
    if input.KeyCode == Enum.KeyCode.F then
        toggleFly()
    end
end)

RunService.Heartbeat:Connect(function()
    moveFly()
end)

-- Sistema de Teleporte Aleatório
local function teleportToRandomLocation()
    local locations = {
        Vector3.new(math.random(-100, 100), 10, math.random(-100, 100)), -- Castelo
        Vector3.new(math.random(-100, 100), 10, math.random(-100, 100)), -- Nikola Tesla Lab
        Vector3.new(math.random(-100, 100), 10, math.random(-100, 100)), -- Cidade Abandonada
        Vector3.new(math.random(-100, 100), 10, math.random(-100, 100))  -- Final
    }
    
    local selectedLocation = locations[math.random(1, #locations)]
    character:SetPrimaryPartCFrame(CFrame.new(selectedLocation))
end

-- Sistema de Key para usar
local key = "baitola"  -- Senha fixa
local userKeyInput = ""

local function checkKey()
    if userKeyInput == key then
        teleportToRandomLocation()
    else
        print("Chave incorreta!")
    end
end

-- Interface Gráfica para Key
local screenGui = Instance.new("ScreenGui", player.PlayerGui)
local textBox = Instance.new("TextBox", screenGui)
textBox.Size = UDim2.new(0, 200, 0, 50)
textBox.Position = UDim2.new(0.5, -100, 0.5, -25)
textBox.PlaceholderText = "Digite a chave..."
textBox.TextChanged:Connect(function()
    userKeyInput = textBox.Text
end)

local submitButton = Instance.new("TextButton", screenGui)
submitButton.Size = UDim2.new(0, 200, 0, 50)
submitButton.Position = UDim2.new(0.5, -100, 0.5, 25)
submitButton.Text = "Submeter"
submitButton.MouseButton1Click:Connect(function()
    checkKey()
end)

-- Botão para copiar link
local copyButton = Instance.new("TextButton", screenGui)
copyButton.Size = UDim2.new(0, 200, 0, 50)
copyButton.Position = UDim2.new(0.5, -100, 0.5, 75)
copyButton.Text = "Get Key"
copyButton.MouseButton1Click:Connect(function()
    setclipboard("https://loot-link.com/s?KCyoj6LG")
end)

-- Script para ativar e desativar a janela
local toggleButton = Instance.new("TextButton", screenGui)
toggleButton.Size = UDim2.new(0, 50, 0, 50)
toggleButton.Position = UDim2.new(0, 10, 0, 10)
toggleButton.Text = "DR"  -- Texto representando Dead Rails
toggleButton.BackgroundColor3 = Color3.fromRGB(255, 0, 0)

local minimized = false
toggleButton.MouseButton1Click:Connect(function()
    if minimized then
        screenGui.Enabled = true
    else
        screenGui.Enabled = false
    end
    minimized = not minimized
end)

-- ESP de itens (Exemplo básico)
local function createESP(part)
    local esp = Instance.new("BillboardGui")
    esp.Adornee = part
    esp.Size = UDim2.new(0, 100, 0, 50)
    esp.StudsOffset = Vector3.new(0, 3, 0)
    esp.Parent = part

    local textLabel = Instance.new("TextLabel", esp)
    textLabel.Text = "Item!"
    textLabel.Size = UDim2.new(1, 0, 1, 0)
    textLabel.BackgroundTransparency = 1
    textLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
end

-- Exemplo: Adicionando ESP a um item
for _, item in pairs(workspace:GetChildren()) do
    if item:IsA("Part") then
        createESP(item)
    end
end
